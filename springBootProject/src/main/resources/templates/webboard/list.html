<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorator="~{layout/layout1}">
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
<th:block layout:fragment="style1">
	<style>
.oddStyle {
	background-color: HoneyDew;
}

.evenStyle {
	background-color: LavenderBlush;
}

.firstStyle {
	color: blue;
}

table {
	border-collapse: collapse;
	margin: 0px auto;
}

#tblContent {
	width: 80%;
	text-align: center;
	margin: 0px auto;
	text-align: center;
}

th, td {
	padding: 5px;
}
</style>
</th:block>
</head>
<body>
	<div class="panel panel-default" layout:fragment="content1">
		<div id="tblContent">
			<h1>ğŸ£WebBoard ListğŸ£</h1>
			<div class="pull-left">
				<select id="searchType">
					<option>ì „ì²´</option>
					<option value="title" th:selected="${pageVO.type=='title'}">ì œëª©</option>
					<option value="content" th:selected="${pageVO.type=='content'}">ë‚´ìš©</option>
					<option value="writer" th:selected="${pageVO.type=='writer'}">ì‘ì„±ì</option>
				</select> <input type="text" id="searchKeyword" th:value="${pageVO.keyword}">
				<button id="searchBtn">ì¡°ê±´ê²€ìƒ‰</button>
				<img alt="ì´ë¯¸ì§€" th:src="@{/images/muffin.png}" width="50px"
					height="50px">
			</div>
			<div class="pull-right">
				<a th:href="@{register.do}">ê²Œì‹œê¸€ ì‘ì„±</a>
			</div>

			<p>[[${msg}]]</p>

			<!-- listì¶œë ¥ -->
			<table class="table table-striped table-bordered"
				th:with="blist2=${blist.result}">
				<!-- with: blist2ë¼ëŠ” ì§€ì—­ë³€ìˆ˜ ë§Œë“¦ -> contentê°€ í•„ìš”í•  ë•Œ, pageê°€ í•„ìš”í•  ë•Œ ë‹¤ ìˆìœ¼ë‹ˆê¹Œ -->
				<tr class="success">
					<th>bno</th>
					<th>title</th>
					<th>content</th>
					<th>writer</th>
					<th>regdate</th>
				</tr>

				<tbody>
					<tr th:each="board:${blist2.content}" class="odd gradeX">
						<td>[[${board.bno}]]</td>
						<td><a class="boardLink" th:href="${board.bno}">[[${board.title}]]</a>
							<!-- ëŒ“ê¸€ìˆ˜ì¶”ê°€ --> <span class="badge">[[${board.replies.size()}]]</span></td>
						<!-- class=badge: ë™ê·¸ë€ ëª¨ì–‘ìœ¼ë¡œ ìƒê¹€(bootstrap) -->
						<td>[[${board.content}]]</td>
						<td>[[${board.writer}]]</td>
						<td class="center">
							[[${#dates.format(board.regdate,'yyyy-MM-dd')}]]</td>
					</tr>
				</tbody>
			</table>

			<!-- ì´ê²Œ PageMaker! ë°ì´í„°ì— ë”°ë¼ 1~n í˜ì´ì§€ë¥¼ ì„¤ì • -->
			<!-- paging -->
			<nav>
				<div>
					<ul class="pagination">
						<li class="page-item" th:if="${blist.prevPage}"><a
							th:href="${blist.prevPage.pageNumber}+1">PREV
								[[${blist.prevPage.pageNumber}+1]]</a></li>
						<li class="page-item"
							th:classappend="${p.pageNumber==blist.currentPageNum-1}?active:''"
							th:each="p:${blist.pageList}"><a th:href="${p.pageNumber}+1">[[${p.pageNumber}+1]]</a>
						</li>
						<li class="page-item" th:if="${blist.nextPage}"><a
							th:href="${blist.nextPage.pageNumber}+1">NEXT
								[[${blist.nextPage.pageNumber}+1]]</a></li>
					</ul>
				</div>
			</nav>

			<!-- ì´ê²Œ ë°”ë¡œ PageVO! ë‚´ í˜ì´ì§€ì— ëŒ€í•œ ì •ë³´ë¥¼ ë“¤ê³  ë‹¤ë‹ˆëŠ” ê²ƒ
			: ìƒì„¸ ì¡°íšŒ, ì¡°ê±´ ê²€ìƒ‰ ë‘˜ ë‹¤ í•„ìš”í•˜ê¸° ë•Œë¬¸ì— ê° í–‰ë™ ì‹œ formì˜ actionì„ ë°”ê¿”ì¤˜ì•¼ í•¨ (JSì—ì„œ form.attr ì‚¬ìš©í•´ actionì„ ìˆ˜ì •í•¨) -->
			<form id="f1" th:action="@{list.do}" method="get">
				<input type="text" name="page" th:value="${blist.currentPageNum}">
				<!-- í˜„ì¬ ní˜ì´ì§€ë¥¼ ë³´ê³  ìˆë‹¤ -->
				<input type="text" name="size"
					th:value="${blist.currentPage.pageSize}">
				<!-- ì´ í˜ì´ì§€ì—ëŠ” nê°œì˜ ë°ì´í„°ê°€ ìˆë‹¤ -->
				<input type="text" name="type" th:value="${pageVO.type}">
				<!-- ì¡°ê±´ì´ ì „ì²´/ì œëª©/ë‚´ìš©/ì‘ì„±ì -->
				<input type="text" name="keyword" th:value="${pageVO.keyword}">
				<!-- ì¡°ê±´ inputì— ì…ë ¥í•œ ë‚´ìš© -->
			</form>
		</div>

		<hr>
		<p>[[${blist}]]</p>
		<!-- blistê¹Œì§€: ì´ì „,ë‹¤ìŒí˜ì´ì§€ ì •ë³´, resultê¹Œì§€: í˜„ì¬ í˜ì´ì§€ ì •ë³´, contentê¹Œì§€: í˜ì´ì§€ì— í•´ë‹¹í•˜ëŠ” ë‚´ìš©ë“¤(ê²Œì‹œê¸€) -->
		<p>[[${blist.result}]]</p>
		<p>[[${blist.result.content}]]</p>

	</div>

	<!-- javascript -->
	<th:block layout:fragment="script1">
		<script th:inline="javascript">
			$(function() {
				//ë“±ë¡í›„ ì¶”ê°€ë¨
				var msg = [[${msg}]];
				/* if (msg == "success") {
					alert("ì •ìƒì ìœ¼ë¡œ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤");
				} */
				if(msg != null) {
					alert(msg);
				}
				
				var formObj = $("#f1");
				$(".pagination a").click(function(e) {
					e.preventDefault(); // pagenationì˜ í˜ì´ì§€ê°€ ì´ë™ë˜ëŠ” ê²ƒì„ ë§‰ìŒ (í˜ì´ì§€ ì •ë³´ë¥¼ ê°€ì ¸ì˜¨ í›„ ì œì¶œë˜ì–´ì•¼ í•¨)
					formObj.find("[name='page']").val($(this).attr('href')); // ë‚´ê°€ ëˆ„ë¥¸ í˜ì´ì§€ë¥¼ ë„£ì–´ì•¼ í•¨ (pageëŠ” ë‚´ê°€ í˜„ì¬ ë³´ê³  ìˆëŠ” í˜ì´ì§€ì´ê¸° ë•Œë¬¸)
					formObj.attr("action", "list.do");
					formObj.submit();
				});

				// ì¡°ê±´ ê²€ìƒ‰
				$("#searchBtn").click(function() {
					var typeStr = $("#searchType").find(":selected").val();
					var keywordStr = $("#searchKeyword").val();
					formObj.find("[name='type']").val(typeStr);
					formObj.find("[name='keyword']").val(keywordStr);
					formObj.find("[name='page']").val(1);
					formObj.attr("action", "list.do");
					formObj.submit();
				});

				// ìƒì„¸ ë³´ê¸°
				$(".boardLink")
						.click(
								function(e) {
									e.preventDefault();
									var boardNo = $(this).attr("href");
									/* alert(boardNo); */
									// ìƒì„¸ ê²€ìƒ‰ í›„ ëŒì•„ì™”ì„ ë•Œ í˜ì´ì§€ ì •ë³´ê°€ ê³„ì† í•„ìš”í•˜ë‹ˆê¹Œ formì„ ê³„ì† í™œìš©
									formObj.attr("action", "view.do");
									var bnoObj = formObj.find("[name='bno']");
									console.log(bnoObj);
									if (!$(bnoObj).val()) {
										formObj
												.append("<input type='text' name='bno' value='"+boardNo+"'>");
									} else {
										$(bnoObj).val(boardNo);
									}
									formObj.submit();
								});
			});
		</script>
	</th:block>
</body>
</html>